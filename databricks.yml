bundle:
  name: cdp_core
  uuid: 98c7c9ce-c84d-4717-b5d8-25950e338d17

include:
  - resources/*.yml
  - resources/*/*.yml

variables:
  deploy_env:
    description: "Environment to deploy the bundle to"
  workspace_URL:
    description: "Workspace URL for Deploying the Jobs"
  SPN:
    description: "Service Principal Name for Deploying the bundle"

targets:
  ${var.deploy_env}:
    mode: ${var.deploy_env}
    workspace:
      host: ${DATABRICKS_HOST}
      root_path: /Workspace/Users/${workspace.current_user.userName}/.bundle/${bundle.name}/${bundle.target}
    run_as:
      service_principal_name: ${var.SPN}

# artifacts:
#   python_artifact:
#     type: whl
#     build: uv build --wheel


# targets:
#   dev:
#     # The default target uses 'mode: development' to create a development copy.
#     # - Deployed resources get prefixed with '[dev my_user_name]'
#     # - Any job schedules and triggers are paused by default.
#     # See also https://docs.databricks.com/dev-tools/bundles/deployment-modes.html.
#     mode: development
#     default: true
#     workspace:
#       host: ${env.DATABRICKS_DEV_HOST}
#       root_path: /Workspace/Users/${workspace.current_user.userName}/.bundle/${bundle.name}/${bundle.target}

#   test:
#     mode: test
#     default: false
#     workspace:
#       host: https://adb-1522315314401091.11.azuredatabricks.net/
#       root_path: /Workspace/Users/${workspace.current_user.userName}/.bundle/${bundle.name}/${bundle.target}

  # prod:
  #   mode: production
  #   workspace:
  #     host: https://adb-1964496556207941.1.azuredatabricks.net
  #     # We explicitly deploy to /Workspace/Users/suawallace@tdigitalcommunities.onmicrosoft.com to make sure we only have a single copy.
  #     root_path: /Workspace/Users/Shared/.bundle/${bundle.name}/${bundle.target}
  #   permissions:
  #     - user_name: suawallace@tdigitalcommunities.onmicrosoft.com
  #       level: CAN_MANAGE
