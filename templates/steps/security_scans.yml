parameters:
  - name: severity
    type: string
  - name: inlineScript
    type: string

steps:
  - script: ${{ parameters.inlineScript }} 
    displayName: "Run Bandit - Source Code Scanner"

  - task: PublishBuildArtifacts@1
    inputs:
      pathToPublish: 'security_reports'
      artifactName: 'security-reports'
      publishLocation: 'Container'
    displayName: "Publish Bandit Scan Report"

  - script: |
      fullCommand="${ parameters.inlineScript } --severity-level ${{ parameters.severity }}"
      eval $fullCommand

  
    displayName: "Run Bandit - Fail on Severity Level"
